<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>mruby-spdy by matsumoto-r</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>mruby-spdy</h1>
          <h2>SPDY Module for mruby</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/matsumoto-r/mruby-spdy/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/matsumoto-r/mruby-spdy/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/matsumoto-r/mruby-spdy" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="spdy-module-for-mruby--" class="anchor" href="#spdy-module-for-mruby--"><span class="octicon octicon-link"></span></a>SPDY Module for mruby  <a href="https://travis-ci.org/matsumoto-r/mruby-spdy"><img src="https://travis-ci.org/matsumoto-r/mruby-spdy.png?branch=master" alt="Build Status"></a>
</h1>

<p>SPDY module for mruby. You can access Web site using SPDY protocol from mruby applications or devices with mruby.</p>

<ul>
<li>
<p><a href="http://www.chromium.org/spdy/spdy-whitepaper">SPDY: An experimental protocol for a faster web</a> </p>

<p>As part of the "Let's make the web faster" initiative, we are experimenting with alternative protocols to help reduce the latency of web pages. One of these experiments is SPDY (pronounced "SPeeDY"), an application-layer protocol for transporting content over the web, designed specifically for minimal latency.</p>
</li>
</ul><h2>
<a name="todo" class="anchor" href="#todo"><span class="octicon octicon-link"></span></a>TODO</h2>

<p>This is a very early version, please test and report errors. Wellcome pull-request.</p>

<ul>
<li>replace uri parser to mruby-http</li>
<li>implement some method (post...)</li>
<li>implement some class (Server, Proxy...)</li>
<li>write spdy callback function by Ruby block</li>
</ul><h2>
<a name="example" class="anchor" href="#example"><span class="octicon octicon-link"></span></a>example</h2>

<ul>
<li>SPDY by mruby</li>
</ul><div class="highlight highlight-ruby"><pre><span class="n">r</span> <span class="o">=</span> <span class="no">SPDY</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">get</span> <span class="s1">'https://www.google.co.jp/'</span>

<span class="n">r</span>
<span class="n">r</span><span class="o">.</span><span class="n">body</span>
<span class="n">r</span><span class="o">.</span><span class="n">body_length</span>
<span class="n">r</span><span class="o">.</span><span class="n">spdy_version</span>
<span class="n">r</span><span class="o">.</span><span class="n">stream_id</span>
<span class="n">r</span><span class="o">.</span><span class="n">syn_reply</span>
<span class="n">r</span><span class="o">.</span><span class="n">syn_stream</span>
</pre></div>

<ul>
<li>response</li>
</ul><div class="highlight highlight-ruby"><pre><span class="c1">#r</span>
<span class="p">{</span>
    <span class="ss">:syn_reply</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="s2">"x-frame-options"</span><span class="o">=&gt;</span><span class="s2">"SAMEORIGIN"</span><span class="p">,</span> 
        <span class="s2">"x-xss-protection"</span><span class="o">=&gt;</span><span class="s2">"1; mode=block"</span><span class="p">,</span> 
        <span class="s2">"expires"</span><span class="o">=&gt;</span><span class="s2">"-1"</span><span class="p">,</span> 
        <span class="s2">"p3p"</span><span class="o">=&gt;</span><span class="s2">"CP=</span><span class="se">\"</span><span class="s2">This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&amp;answer=151657 for more info.</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span> 
        <span class="s2">"server"</span><span class="o">=&gt;</span><span class="s2">"gws"</span><span class="p">,</span> 
        <span class="s2">"set-cookie"</span><span class="o">=&gt;</span><span class="s2">"; expires=Sun, 29-Jun-2014 17:16:55 GMT; path=/; domain=.google.co.jp; HttpOnly"</span><span class="p">,</span> 
        <span class="s2">":version"</span><span class="o">=&gt;</span><span class="s2">"HTTP/1.1"</span><span class="p">,</span> 
        <span class="s2">"alternate-protocol"</span><span class="o">=&gt;</span><span class="s2">"443:quic"</span><span class="p">,</span> 
        <span class="s2">"cache-control"</span><span class="o">=&gt;</span><span class="s2">"private, max-age=0"</span><span class="p">,</span> 
        <span class="s2">"content-type"</span><span class="o">=&gt;</span><span class="s2">"text/html; charset=Shift_JIS"</span><span class="p">,</span> 
        <span class="s2">"date"</span><span class="o">=&gt;</span><span class="s2">"Sat, 28 Dec 2013 17:16:55 GMT"</span><span class="p">,</span> 
        <span class="s2">":status"</span><span class="o">=&gt;</span><span class="s2">"200 OK"</span>
    <span class="p">},</span> 
    <span class="ss">:recieve_bytes</span><span class="o">=&gt;</span><span class="mi">953</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> 
    <span class="ss">:body</span><span class="o">=&gt;</span><span class="s2">"&lt;html&gt; - (snip) - &lt;/html&gt;"</span><span class="p">,</span> 
    <span class="ss">:body_length</span><span class="o">=&gt;</span><span class="mi">953</span><span class="p">,</span> 
    <span class="ss">:spdy_proto_version</span><span class="o">=&gt;</span><span class="mi">4</span><span class="p">,</span> 
    <span class="ss">:stream_id</span><span class="o">=&gt;</span><span class="mi">1</span><span class="p">,</span> 
    <span class="ss">:syn_stream</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="s2">":method"</span><span class="o">=&gt;</span><span class="s2">"GET"</span><span class="p">,</span> 
        <span class="s2">":path"</span><span class="o">=&gt;</span><span class="s2">"/"</span><span class="p">,</span> 
        <span class="s2">":scheme"</span><span class="o">=&gt;</span><span class="s2">"https"</span><span class="p">,</span> 
        <span class="s2">":version"</span><span class="o">=&gt;</span><span class="s2">"HTTP/1.1"</span><span class="p">,</span> 
        <span class="s2">":host"</span><span class="o">=&gt;</span><span class="s2">"www.google.co.jp"</span><span class="p">,</span> 
        <span class="s2">"accept"</span><span class="o">=&gt;</span><span class="s2">"*/*"</span><span class="p">,</span> 
        <span class="s2">"user-agent"</span><span class="o">=&gt;</span><span class="s2">"mruby-spdy/0.0.1"</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">#r.body</span>
<span class="s2">"&lt;html&gt; - (snip) - &lt;/html&gt;"</span>

<span class="c1">#r.body_length</span>
<span class="mi">953</span>

<span class="c1">#r.spdy_version</span>
<span class="mi">4</span>

<span class="c1">#r.syn_stream</span>
<span class="p">{</span>
  <span class="s2">":method"</span><span class="o">=&gt;</span><span class="s2">"GET"</span><span class="p">,</span>
  <span class="s2">":path"</span><span class="o">=&gt;</span><span class="s2">"/"</span><span class="p">,</span>
  <span class="s2">":scheme"</span><span class="o">=&gt;</span><span class="s2">"https"</span><span class="p">,</span>
  <span class="s2">":version"</span><span class="o">=&gt;</span><span class="s2">"HTTP/1.1"</span><span class="p">,</span>
  <span class="s2">":host"</span><span class="o">=&gt;</span><span class="s2">"www.google.co.jp"</span><span class="p">,</span>
  <span class="s2">"accept"</span><span class="o">=&gt;</span><span class="s2">"*/*"</span><span class="p">,</span>
  <span class="s2">"user-agent"</span><span class="o">=&gt;</span><span class="s2">"mruby-spdy/0.0.1"</span>
<span class="p">}</span>

<span class="c1">#r.syn_reply</span>
<span class="p">{</span>
  <span class="s2">"x-frame-options"</span><span class="o">=&gt;</span><span class="s2">"SAMEORIGIN"</span><span class="p">,</span>
  <span class="s2">"x-xss-protection"</span><span class="o">=&gt;</span><span class="s2">"1; mode=block"</span><span class="p">,</span>
  <span class="s2">"expires"</span><span class="o">=&gt;</span><span class="s2">"-1"</span><span class="p">,</span>
  <span class="s2">"p3p"</span><span class="o">=&gt;</span><span class="s2">"CP=</span><span class="se">\"</span><span class="s2">This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&amp;answer=151657 for more info.</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span>
  <span class="s2">"server"</span><span class="o">=&gt;</span><span class="s2">"gws"</span><span class="p">,</span>
  <span class="s2">"set-cookie"</span><span class="o">=&gt;</span><span class="s2">"; expires=Sun, 29-Jun-2014 17:16:55 GMT; path=/; domain=.google.co.jp; HttpOnly"</span><span class="p">,</span>
  <span class="s2">":version"</span><span class="o">=&gt;</span><span class="s2">"HTTP/1.1"</span><span class="p">,</span>
  <span class="s2">"alternate-protocol"</span><span class="o">=&gt;</span><span class="s2">"443:quic"</span><span class="p">,</span>
  <span class="s2">"cache-control"</span><span class="o">=&gt;</span><span class="s2">"private, max-age=0"</span><span class="p">,</span>
  <span class="s2">"content-type"</span><span class="o">=&gt;</span><span class="s2">"text/html; charset=Shift_JIS"</span><span class="p">,</span>
  <span class="s2">"date"</span><span class="o">=&gt;</span><span class="s2">"Sat, 28 Dec 2013 17:16:55 GMT"</span><span class="p">,</span>
  <span class="s2">":status"</span><span class="o">=&gt;</span><span class="s2">"200 OK"</span>
<span class="p">}</span>

</pre></div>

<h2>
<a name="install-by-mrbgems" class="anchor" href="#install-by-mrbgems"><span class="octicon octicon-link"></span></a>install by mrbgems</h2>

<ul>
<li>Download</li>
</ul><pre><code>git clone https://github.com/mruby/mruby.git
git clone https://github.com/matsumoto-r/mruby-spdy.git
</code></pre>

<ul>
<li>spdylay build</li>
</ul><pre><code>cd mruby-spdy
git submodule init
git submodule update
cd src/spdylay
autoreconf -i
automake
autoconf
./configure
make
cd ../../../
</code></pre>

<ul>
<li>add conf.gem line to <code>build_config.rb</code>
</li>
</ul><pre><code>cd mruby
</code></pre>

<div class="highlight highlight-ruby"><pre><span class="no">MRuby</span><span class="o">::</span><span class="no">Build</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>

  <span class="c1"># ... (snip) ...</span>

  <span class="n">conf</span><span class="o">.</span><span class="n">gem</span> <span class="s1">'../mruby-spdy'</span>
<span class="k">end</span>
</pre></div>

<ul>
<li>build</li>
</ul><pre><code>rake
</code></pre>

<h1>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h1>

<p>under the MIT License:</p>

<ul>
<li><a href="http://www.opensource.org/licenses/mit-license.php">http://www.opensource.org/licenses/mit-license.php</a></li>
</ul>
        </section>

        <footer>
          mruby-spdy is maintained by <a href="https://github.com/matsumoto-r">matsumoto-r</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>